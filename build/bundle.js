(()=>{"use strict";function a(d){var e=c[d];if(void 0!==e)return e.exports;var f=c[d]={exports:{}};return b[d](f,f.exports,a),f.exports}var b={"./src/index.js":/*!**********************!*\
  !*** ./src/index.js ***!
  \**********************/(a,b,c)=>{c.r(b);var d=c(/*! ./tictactoe */"./src/tictactoe.js"),e=c(/*! ./sass/main.scss */"./src/sass/main.scss");(function(){window.addEventListener("scroll",function(){document.querySelector("header").style.opacity=document.documentElement.scrollTop>150?.9:1});var a=document.getElementById("sword-logo"),b=document.getElementById("facebook"),c=document.getElementById("twitter"),e=document.getElementById("instagram"),f=document.getElementById("send");a.src="./assets/img/SWORD_Health_logo.svg",b.src="./assets/img/facebook.svg",c.src="./assets/img/twitter.svg",e.src="./assets/img/instagram.svg",f.src="./assets/img/send.svg";var g=document.getElementById("select-grid-size");g.addEventListener("change",function(a){g.setAttribute("disabled","disabled");try{document.querySelectorAll("[data-game-area]").forEach(function(a){a.style.visibility="visible"}),document.getElementById("time-counter").style.visibility="visible";var b=new d.TicTacToe(+a.target.value);b.onInit()}catch(a){console.error(a)}})}).call()},"./src/swordgames.js":/*!***************************!*\
  !*** ./src/swordgames.js ***!
  \***************************/(a,b,c)=>{function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function f(a,b,c){return b&&e(a.prototype,b),c&&e(a,c),a}c.r(b),c.d(b,{SwordGames:()=>g});var g=function(){function a(){d(this,a),this.game="tictactoe",this.player="1",this.boardStatus=[],this.winningConditions=[],this.roundWinsByPlayer={player1:0,player2:0},this.currentTimeSpent=0,this.clockId=null,this.statistics={totalGamesPlayed:0,history:[],aggregatedTime:"00:00:00",player1Wins:0,player2Wins:0};var b=localStorage.getItem("stats");return b?void(this.statistics=JSON.parse(b)):void localStorage.setItem("stats",JSON.stringify(this.statistics))}return f(a,[{key:"onInit",value:function(){throw"NotImplementedException"}},{key:"buildBoard",value:function(){throw"NotImplementedException"}},{key:"setEventListeners",value:function(){throw"NotImplementedException"}},{key:"onDestroy",value:function(){if("tictactoe"===this.game)for(var a=document.querySelectorAll(".flex-item"),b=a.length,c=0;c<b;c++)a[c].removeEventListener("click",this.onCellClicked)}},{key:"highlightSelectedPlayer",value:function(){var a=!!(0<arguments.length&&void 0!==arguments[0])&&arguments[0];return a?void(document.querySelectorAll("[data-player=\"1\"]").forEach(function(a){a.classList.add("current-player")}),document.querySelectorAll("[data-player=\"2\"]").forEach(function(a){a.classList.remove("current-player")})):(document.querySelectorAll("[data-player=\"1\"]").forEach(function(a){a.classList.toggle("current-player")}),void document.querySelectorAll("[data-player=\"2\"]").forEach(function(a){a.classList.toggle("current-player")}))}},{key:"updatePlayerCount",value:function(){var a=this;document.querySelectorAll("[data-player-count-id=\"".concat(this.player,"\"]")).forEach(function(b){b.innerText=a.roundWinsByPlayer["player".concat(a.player)]})}},{key:"timeCounter",value:function(){var a=Math.floor,b=a(this.currentTimeSpent/3600),c=a((this.currentTimeSpent-3600*b)/60),d=this.currentTimeSpent-3600*b-60*c;return 10>b&&(b="0"+b),10>c&&(c="0"+c),10>d&&(d="0"+d),b+":"+c+":"+d}},{key:"clock",value:function(){var a=this;this.clockId=setInterval(function(){document.querySelectorAll("[data-time-counter]").forEach(function(b){b.innerText=a.timeCounter()}),a.currentTimeSpent++},1e3)}},{key:"timeAccumulator",value:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"00:00:00";if(/\d{2}:\d{2}:\d{2}/.test(a)){var b=["00","00","00"],c=a.split(":"),d=this.statistics.aggregatedTime.split(":"),e=+c[2]+ +d[2],f=+c[1]+ +d[1],g=+c[0]+ +d[0];if(60<=e){var i=e/60<<0;f+=i,e-=60*i}if(60<=f){var j=f/60<<0;g+=j,f-=60*j}return b[0]=10>g?"0"+g:g.toString(),b[1]=10>f?"0"+f:f.toString(),b[2]=10>e?"0"+e:e.toString(),b.join(":")}return this.statistics.aggregatedTime}},{key:"restartGame",value:function(){this.player="1",this.boardStatus.fill("");for(var a=document.querySelectorAll(".flex-item"),b=a.length,c=["player1","player2","player1Win","player2Win","winning-cell"],d=0;d<b;d++){var e;(e=a[d].classList).remove.apply(e,c)}this.highlightSelectedPlayer(!0)}},{key:"triggerPopup",value:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",b=function a(){var b=document.getElementById("message");document.getElementById("modal-close").removeEventListener("click",a),document.body.removeChild(b)},c=document.createElement("div");c.id="message",c.classList.add("modal"),c.innerHTML="\n\t\t<div class=\"modal-content\">\n\t\t\t<div id=\"modal-close\" class=\"close\">&times;</div>\n\t\t\t<h1>Winner!!!</h1>\n\t\t\t<div class=\"body\">\n\t\t\t\tCongrats ".concat(a,"!!!\n\t\t\t</div>\n\t\t</div>\n\t\t"),document.body.appendChild(c),setTimeout(function(){document.getElementById("modal-close").addEventListener("click",b)})}},{key:"updateStatistics",value:function(){var a=Math.round,b=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];if(this.statistics.totalGamesPlayed){var c=a(100*(this.statistics.player1Wins/this.statistics.totalGamesPlayed)),d=a(100*(this.statistics.player2Wins/this.statistics.totalGamesPlayed));document.getElementById("p1W").innerText=c+"%",document.getElementById("p1L").innerText=100-c+"%",document.getElementById("p2W").innerText=d+"%",document.getElementById("p2L").innerText=100-d+"%";for(var e=0;e<this.statistics.totalGamesPlayed&&9>e;e++)document.querySelector("[data-played-matches=\"".concat(e,"\"]")).classList.add("played"),document.querySelector("[data-game-history=\"".concat(e,"\"]")).innerText=this.statistics.history[e];9<this.statistics.totalGamesPlayed&&(document.getElementById("extra").innerText="+ "+(this.statistics.totalGamesPlayed-9));var f=document.getElementById("agreggated-time");f.innerText=b?this.statistics.aggregatedTime:this.timeAccumulator(this.timeCounter())}}}]),a}()},"./src/tictactoe.js":/*!**************************!*\
  !*** ./src/tictactoe.js ***!
  \**************************/(a,b,c)=>{function d(a){"@babel/helpers - typeof";return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},d(a)}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function g(a,b,c){return b&&f(a.prototype,b),c&&f(a,c),a}function h(a,b,c){return h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(a,b,c){var d=i(a,b);if(d){var e=Object.getOwnPropertyDescriptor(d,b);return e.get?e.get.call(c):e.value}},h(a,b,c||a)}function i(a,b){for(;!Object.prototype.hasOwnProperty.call(a,b)&&(a=p(a),null!==a););return a}function j(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),b&&k(a,b)}function k(a,b){return k=Object.setPrototypeOf||function(a,b){return a.__proto__=b,a},k(a,b)}function l(a){var b=o();return function(){var c,d=p(a);if(b){var e=p(this).constructor;c=Reflect.construct(d,arguments,e)}else c=d.apply(this,arguments);return m(this,c)}}function m(a,b){return b&&("object"===d(b)||"function"==typeof b)?b:n(a)}function n(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function o(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function p(a){return p=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)},p(a)}c.r(b),c.d(b,{TicTacToe:()=>r});var q=c(/*! ./swordgames */"./src/swordgames.js"),r=function(a){function b(){var a,d=0<arguments.length&&void 0!==arguments[0]?arguments[0]:3;return e(this,b),a=c.call(this),a.boardSize=d,a}j(b,a);var c=l(b);return g(b,[{key:"onInit",value:function(){var a=this;this.winningConditions=Array.from({length:2*this.boardSize+2},function(){return Array(a.boardSize)}),this.boardStatus=Array(this.boardSize*this.boardSize).fill(""),this.buildRows(),this.buildCols(),this.buildLtrDiag(),this.buildRtrDiag(),this.buildBoard(),this.setEventListeners(),h(p(b.prototype),"highlightSelectedPlayer",this).call(this,!0),this.clock(),this.updateStatistics()}},{key:"buildRows",value:function(){for(var a=-1,b=0;b<this.boardSize;b++)for(var c=0;c<this.boardSize;c++)++a,this.winningConditions[b][c]=a}},{key:"buildCols",value:function(){for(var a=-1,b=this.winningConditions.length,c=0;c<this.boardSize;c++)for(var d=this.boardSize;d<=b-3;d++)++a,this.winningConditions[d][c]=a}},{key:"buildLtrDiag",value:function(){for(var a=this.winningConditions.length,b=0;b<this.boardSize;b++)this.winningConditions[a-2][b]=b*(this.boardSize+1)}},{key:"buildRtrDiag",value:function(){for(var b=this.boardSize-1,a=this.winningConditions.length,c=0;c<this.boardSize;c++)this.winningConditions[a-1][c]=c*b+b}},{key:"buildBoard",value:function(){for(var a=document.querySelector("#board"),b="",c=-1,d=0;d<this.boardSize;d++){b+="<div class=\"flex-container\">";for(var e=0;e<this.boardSize;e++)++c,b+="<div class=\"flex-item\" data-cell-id=\"".concat(c,"\"></div>");b+="</div>"}a.innerHTML=b}},{key:"setEventListeners",value:function(){for(var a=document.querySelectorAll(".flex-item"),b=a.length,c=0;c<b;c++)a[c].addEventListener("click",this.onCellClicked.bind(this))}},{key:"onCellClicked",value:function(a){try{var b=+a.target.dataset.cellId;if(console.debug("on cell clicked",this.dataset),""!==this.boardStatus[b])return;this.cellPlayedHandler(a.target,b)}catch(a){console.error(a)}}},{key:"cellPlayedHandler",value:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:-1;if(!a||-1===b)throw"InvalidCellException";a.classList.add("1"===this.player?"player1":"player2"),this.boardStatus[b]=this.player,this.checkWin()}},{key:"checkWin",value:function(){for(var a,c=this,d=!1,e=!1,f=this.winningConditions.length,g=null,j=function(a){g=c.winningConditions[a];for(var b=[],e=0;e<c.boardSize;e++)b.push(c.boardStatus[g[e]]);return b.some(function(a){return""===a})?"continue":b.every(function(a){return a===b[0]})?(d=!0,"break"):void 0},k=0;k<f&&(a=j(k),"continue"===a||"break"!==a);k++);if(d){for(var i=0;i<this.boardSize;i++){var l=g[i],m=document.querySelector("[data-cell-id=\"".concat(l,"\"]"));m.classList.add("player".concat(this.player,"Win"),"winning-cell"),m.classList.remove("player".concat(this.player))}if(setTimeout(function(){c.restartGame()},4e3),this.roundWinsByPlayer["player"+this.player]+=1,this.updatePlayerCount(),5===this.roundWinsByPlayer.player1||5===this.roundWinsByPlayer.player2){clearInterval(this.clockId);var n=5===this.roundWinsByPlayer.player1?1:2;h(p(b.prototype),"triggerPopup",this).call(this,1==n?"player1":"player2"),document.querySelectorAll("[data-time-counter]").forEach(function(a){a.innerText=c.timeCounter()}),document.querySelectorAll("[data-player-count-id]").forEach(function(a){a.innerText=0}),document.querySelectorAll("[data-game-area]").forEach(function(a){a.style.visibility="hidden"}),document.getElementById("time-counter").style.visibility="hidden",document.getElementById("board").innerHTML="";var o=document.getElementById("select-grid-size");o.value="---",o.removeAttribute("disabled"),this.statistics.totalGamesPlayed+=1;var q=this.statistics.history.length;9>q?this.statistics.history.push(1==n?"P1":"P2"):this.statistics.history[q-1]=1==n?"P1":"P2",this.statistics.aggregatedTime=this.timeAccumulator(this.timeCounter()),1==n?this.statistics.player1Wins+=1:this.statistics.player2Wins+=1,this.roundWinsByPlayer.player1=0,this.roundWinsByPlayer.player2=0,this.boardStatus.length=0,this.winningConditions.length=0,this.currentTimeSpent=0,this.onDestroy(),this.updateStatistics(!1),localStorage.setItem("stats",JSON.stringify(this.statistics)),document.getElementsByClassName("statistics-container")[0].scrollIntoView({behavior:"smooth",block:"center"})}return}return e=!this.boardStatus.includes(""),e?void this.restartGame():void this.managePlayerChange()}},{key:"managePlayerChange",value:function(){this.player="1"===this.player?"2":"1",h(p(b.prototype),"highlightSelectedPlayer",this).call(this)}}]),b}(q.SwordGames)},"./src/sass/main.scss":/*!****************************!*\
  !*** ./src/sass/main.scss ***!
  \****************************/(a,b,c)=>{c.r(b)}},c={};(()=>{a.d=(b,c)=>{for(var d in c)a.o(c,d)&&!a.o(b,d)&&Object.defineProperty(b,d,{enumerable:!0,get:c[d]})}})(),(()=>{a.o=(a,b)=>Object.prototype.hasOwnProperty.call(a,b)})(),(()=>{a.r=(a)=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})}})(),a("./src/index.js");a("./src/sass/main.scss")})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zd29yZGdhbWVzL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL3N3b3JkZ2FtZXMvLi9zcmMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vc3dvcmRnYW1lcy8uL3NyYy9zd29yZGdhbWVzLmpzIiwid2VicGFjazovL3N3b3JkZ2FtZXMvLi9zcmMvdGljdGFjdG9lLmpzIiwid2VicGFjazovL3N3b3JkZ2FtZXMvd2VicGFjay9ydW50aW1lL2RlZmluZSBwcm9wZXJ0eSBnZXR0ZXJzIiwid2VicGFjazovL3N3b3JkZ2FtZXMvd2VicGFjay9ydW50aW1lL2hhc093blByb3BlcnR5IHNob3J0aGFuZCIsIndlYnBhY2s6Ly9zd29yZGdhbWVzL3dlYnBhY2svcnVudGltZS9tYWtlIG5hbWVzcGFjZSBvYmplY3QiLCJ3ZWJwYWNrOi8vc3dvcmRnYW1lcy93ZWJwYWNrL3N0YXJ0dXAiXSwibmFtZXMiOlsid2luZG93IiwiZG9jdW1lbnQiLCJsb2dvIiwiZmFjZWJvb2siLCJ0d2l0dGVyIiwiaW5zdGFncmFtIiwic2VuZCIsImdyaWRTaXplIiwiZWxlbWVudCIsInRpY1RhY1RvZSIsIlRpY1RhY1RvZSIsImV2IiwiY29uc29sZSIsInBsYXllcjEiLCJwbGF5ZXIyIiwidG90YWxHYW1lc1BsYXllZCIsImhpc3RvcnkiLCJhZ2dyZWdhdGVkVGltZSIsInBsYXllcjFXaW5zIiwicGxheWVyMldpbnMiLCJzYXZlZFN0YXRzIiwibG9jYWxTdG9yYWdlIiwiSlNPTiIsImJvYXJkQ2VsbHMiLCJib2FyZENlbGxzTGVuZ3RoIiwiaSIsImlzSW5pdGlhbGl6YXRpb24iLCJNYXRoIiwiaG91cnMiLCJtaW51dGVzIiwic2Vjb25kcyIsInNldEludGVydmFsIiwidG9BZGQiLCJ0aW1lIiwiYWRkaXRpb24iLCJhY2MiLCJtIiwiaCIsImFwcGxpZWRDbGFzc2VzIiwibWVzc2FnZSIsImNsb3NlIiwibW9kYWwiLCJkaWFsb2ciLCJzZXRUaW1lb3V0IiwiYm9hcmRTaXplIiwibGVuZ3RoIiwicm93QWNjdW11bGF0b3IiLCJyb3ciLCJjb2xBY2N1bXVsYXRvciIsIndpbm5pbmdDb25kaXRpb25zTGVuZ3RoIiwiY29sIiwiYSIsImJvYXJkQ29udGFpbmVyIiwiYm9hcmQiLCJjb3VudGVyIiwiaiIsImNsaWNrZWRDZWxsIiwiY2VsbCIsImNlbGxJbmRleCIsIndpbm5pbmdDb25kaXRpb24iLCJ0ZXN0IiwiZWxlbSIsInZpY3RvcnkiLCJjZWxsSWQiLCJib2FyZENlbGwiLCJjbGVhckludGVydmFsIiwicGxheWVyVmljdG9yaW91cyIsImdyaWRTaXplU2VsZWN0IiwiaGlzdG9yeUxlbmd0aCIsImJlaGF2aW9yIiwiYmxvY2siLCJkcmF3IiwiU3dvcmRHYW1lcyJdLCJtYXBwaW5ncyI6Im1CQUlBLGNBRUEsV0FDQSxjQUNBLGlCQUdBLFlBR0EsVUFIQSxFQVVBLE1BSEEsb0JBR0EsVUFDQSxDOzs4SUNuQkEsQ0FBQyxVQUFXLENBR1JBLGlDQUFrQyxVQUFNLENBSWhDQyw4Q0FKZ0MsQ0FHaENBLHlCQUFKLFNBQUlBLENBRkosR0FEb0MsQ0FJaENBLEVBSmdDLENBTWhDQSxDQU5SRCxFQUhRLENBYVIsR0FBSUUsR0FBT0Qsd0JBQVgsWUFBV0EsQ0FBWCxDQUNJRSxFQUFXRix3QkFEZixVQUNlQSxDQURmLENBRUlHLEVBQVVILHdCQUZkLFNBRWNBLENBRmQsQ0FHSUksRUFBWUosd0JBSGhCLFdBR2dCQSxDQUhoQixDQUlJSyxFQUFPTCx3QkFKWCxNQUlXQSxDQUpYLENBTUFDLDBDQW5CUSxDQW9CUkMsaUNBcEJRLENBcUJSQyxnQ0FyQlEsQ0FzQlJDLGtDQXRCUSxDQXVCUkMsNkJBdkJRLENBeUJSLEdBQUlDLEdBQVdOLHdCQUFmLGtCQUFlQSxDQUFmLENBQ0FNLDRCQUFvQyxXQUFNLENBQ3RDQSxxQ0FEc0MsQ0FFdEMsR0FBSSxDQUNBTixzREFBc0QsV0FBVyxDQUM3RE8sNEJBREpQLEVBREEsQ0FJQUEsa0VBSkEsQ0FLQSxHQUFJUSxHQUFZLEdBQUlDLEdBQUosVUFBYyxDQUFD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QUErQkMsRUFBL0IsVzs7bURIREEsSSxPSUFBLFlBQ0EsZUFDQSxtQkFEQSxFQUVBLDJCQUF3QyxhQUF4QyxDQUF3QyxRQUF4QyxFQUdBLEMsV0NQQSxvRCxXQ0NBLFVBQ0EsOENBREEsRUFFQSw0Q0FBc0QsY0FBdEQsRUFGQSxDQUlBLHNDQUErQyxRQUEvQyxFQUNBLEMsS0NKQSxtQixDQUVBLHlCIiwiZmlsZSI6ImJ1bmRsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vIFRoZSBtb2R1bGUgY2FjaGVcbnZhciBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18gPSB7fTtcblxuLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbmZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG5cdHZhciBjYWNoZWRNb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdO1xuXHRpZiAoY2FjaGVkTW9kdWxlICE9PSB1bmRlZmluZWQpIHtcblx0XHRyZXR1cm4gY2FjaGVkTW9kdWxlLmV4cG9ydHM7XG5cdH1cblx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcblx0dmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7XG5cdFx0Ly8gbm8gbW9kdWxlLmlkIG5lZWRlZFxuXHRcdC8vIG5vIG1vZHVsZS5sb2FkZWQgbmVlZGVkXG5cdFx0ZXhwb3J0czoge31cblx0fTtcblxuXHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cblx0X193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0obW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cblx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcblx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xufVxuXG4iLCJpbXBvcnQge1RpY1RhY1RvZX0gZnJvbSAnLi90aWN0YWN0b2UnO1xyXG5pbXBvcnQgJy4vc2Fzcy9tYWluLnNjc3MnO1xyXG5cclxuKGZ1bmN0aW9uKCkge1xyXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJzY3JvbGxcIiwgKCkgPT4ge1xyXG4gICAgICAgIGxldCBsaW1pdCA9IDE1MDtcclxuXHJcbiAgICAgICAgaWYgKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxUb3AgPiBsaW1pdCkge1xyXG4gICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdoZWFkZXInKS5zdHlsZS5vcGFjaXR5ID0gMC45O1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2hlYWRlcicpLnN0eWxlLm9wYWNpdHkgPSAxO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGxldCBsb2dvID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3N3b3JkLWxvZ28nKSxcclxuICAgICAgICBmYWNlYm9vayA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmYWNlYm9vaycpLFxyXG4gICAgICAgIHR3aXR0ZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHdpdHRlcicpLFxyXG4gICAgICAgIGluc3RhZ3JhbSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpbnN0YWdyYW0nKSxcclxuICAgICAgICBzZW5kID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NlbmQnKTtcclxuXHJcbiAgICBsb2dvLnNyYyA9ICcuL2Fzc2V0cy9pbWcvU1dPUkRfSGVhbHRoX2xvZ28uc3ZnJztcclxuICAgIGZhY2Vib29rLnNyYyA9ICcuL2Fzc2V0cy9pbWcvZmFjZWJvb2suc3ZnJztcclxuICAgIHR3aXR0ZXIuc3JjID0gJy4vYXNzZXRzL2ltZy90d2l0dGVyLnN2Zyc7XHJcbiAgICBpbnN0YWdyYW0uc3JjID0gJy4vYXNzZXRzL2ltZy9pbnN0YWdyYW0uc3ZnJztcclxuICAgIHNlbmQuc3JjID0gJy4vYXNzZXRzL2ltZy9zZW5kLnN2Zyc7XHJcblxyXG4gICAgbGV0IGdyaWRTaXplID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NlbGVjdC1ncmlkLXNpemUnKTtcclxuICAgIGdyaWRTaXplLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGV2ID0+IHtcclxuICAgICAgICBncmlkU2l6ZS5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgJ2Rpc2FibGVkJyk7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnW2RhdGEtZ2FtZS1hcmVhXScpLmZvckVhY2goZWxlbWVudCA9PiB7XHJcbiAgICAgICAgICAgICAgICBlbGVtZW50LnN0eWxlLnZpc2liaWxpdHkgPSAndmlzaWJsZSc7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndGltZS1jb3VudGVyJykuc3R5bGUudmlzaWJpbGl0eSA9ICd2aXNpYmxlJztcclxuICAgICAgICAgICAgbGV0IHRpY1RhY1RvZSA9IG5ldyBUaWNUYWNUb2UoK2V2LnRhcmdldC52YWx1ZSk7XHJcbiAgICAgICAgICAgIHRpY1RhY1RvZS5vbkluaXQoKTtcclxuICAgICAgICB9IGNhdGNoKGUpIHtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcihlKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxuICAgIFxyXG59KS5jYWxsKCk7XHJcbiIsImV4cG9ydCBjbGFzcyBTd29yZEdhbWVzIHtcclxuXHRjb25zdHJ1Y3RvcigpIHtcclxuXHRcdHRoaXMuZ2FtZSA9IFwidGljdGFjdG9lXCI7XHJcblx0XHR0aGlzLnBsYXllciA9ICcxJztcclxuXHRcdHRoaXMuYm9hcmRTdGF0dXMgPSBbXTtcclxuXHRcdHRoaXMud2lubmluZ0NvbmRpdGlvbnMgPSBbXTtcclxuXHRcdHRoaXMucm91bmRXaW5zQnlQbGF5ZXIgPSB7XHJcbiAgICAgICAgICAgIHBsYXllcjE6IDAsXHJcbiAgICAgICAgICAgIHBsYXllcjI6IDBcclxuICAgICAgICB9O1xyXG5cdFx0dGhpcy5jdXJyZW50VGltZVNwZW50ID0gMDtcclxuXHRcdHRoaXMuY2xvY2tJZCA9IG51bGw7XHJcblx0XHR0aGlzLnN0YXRpc3RpY3MgPSB7XHJcblx0XHRcdHRvdGFsR2FtZXNQbGF5ZWQ6IDAsXHJcblx0XHRcdGhpc3Rvcnk6IFtdLFxyXG5cdFx0XHRhZ2dyZWdhdGVkVGltZTogJzAwOjAwOjAwJyxcclxuXHRcdFx0cGxheWVyMVdpbnM6IDAsXHJcblx0XHRcdHBsYXllcjJXaW5zOiAwXHJcblx0XHR9O1xyXG5cclxuXHRcdGxldCBzYXZlZFN0YXRzID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3N0YXRzJyk7XHJcblx0XHRpZiAoIXNhdmVkU3RhdHMpIHtcclxuXHRcdFx0bG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3N0YXRzJyxKU09OLnN0cmluZ2lmeSh0aGlzLnN0YXRpc3RpY3MpKTtcclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fVxyXG5cclxuXHRcdHRoaXMuc3RhdGlzdGljcyA9IEpTT04ucGFyc2Uoc2F2ZWRTdGF0cyk7XHJcblx0fVxyXG5cclxuXHRvbkluaXQoKSB7XHJcblx0XHR0aHJvdygnTm90SW1wbGVtZW50ZWRFeGNlcHRpb24nKTtcdFxyXG5cdH1cclxuXHJcblx0YnVpbGRCb2FyZCgpIHtcclxuXHRcdHRocm93KCdOb3RJbXBsZW1lbnRlZEV4Y2VwdGlvbicpO1x0XHJcblx0fVxyXG5cclxuXHRzZXRFdmVudExpc3RlbmVycygpIHtcclxuXHRcdHRocm93KCdOb3RJbXBsZW1lbnRlZEV4Y2VwdGlvbicpO1x0XHJcblx0fVxyXG5cclxuXHRvbkRlc3Ryb3koKSB7XHJcblx0XHRpZiAodGhpcy5nYW1lID09PSAndGljdGFjdG9lJykge1xyXG5cdFx0XHRsZXQgYm9hcmRDZWxscyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5mbGV4LWl0ZW0nKSxcclxuXHRcdFx0XHRib2FyZENlbGxzTGVuZ3RoID0gYm9hcmRDZWxscy5sZW5ndGg7XHJcblxyXG5cdFx0XHRmb3IobGV0IGkgPSAwOyBpIDwgYm9hcmRDZWxsc0xlbmd0aDsgaSsrKSB7XHJcblx0XHRcdFx0Ym9hcmRDZWxsc1tpXS5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMub25DZWxsQ2xpY2tlZCk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdGhpZ2hsaWdodFNlbGVjdGVkUGxheWVyKGlzSW5pdGlhbGl6YXRpb24gPSBmYWxzZSkge1xyXG5cclxuXHRcdGlmICghaXNJbml0aWFsaXphdGlvbikge1xyXG5cclxuXHRcdFx0ZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChgW2RhdGEtcGxheWVyPVwiMVwiXWApLmZvckVhY2goZWxlbWVudCA9PiB7XHJcblx0XHRcdFx0ZWxlbWVudC5jbGFzc0xpc3QudG9nZ2xlKCdjdXJyZW50LXBsYXllcicpO1xyXG5cdFx0XHR9KTtcclxuXHRcclxuXHRcdFx0ZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChgW2RhdGEtcGxheWVyPVwiMlwiXWApLmZvckVhY2goZWxlbWVudCA9PiB7XHJcblx0XHRcdFx0ZWxlbWVudC5jbGFzc0xpc3QudG9nZ2xlKCdjdXJyZW50LXBsYXllcicpO1xyXG5cdFx0XHR9KTtcclxuXHRcdFx0cmV0dXJuO1x0XHJcblx0XHR9XHJcblxyXG5cdFx0ZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChgW2RhdGEtcGxheWVyPVwiMVwiXWApLmZvckVhY2goZWxlbWVudCA9PiB7XHJcblx0XHRcdGVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnY3VycmVudC1wbGF5ZXInKTtcclxuXHRcdH0pO1xyXG5cclxuXHRcdGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoYFtkYXRhLXBsYXllcj1cIjJcIl1gKS5mb3JFYWNoKGVsZW1lbnQgPT4ge1xyXG5cdFx0XHRlbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ2N1cnJlbnQtcGxheWVyJyk7XHJcblx0XHR9KTtcclxuXHR9XHJcblxyXG5cdHVwZGF0ZVBsYXllckNvdW50KCkge1xyXG5cdFx0ZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChgW2RhdGEtcGxheWVyLWNvdW50LWlkPVwiJHt0aGlzLnBsYXllcn1cIl1gKS5mb3JFYWNoKGVsZW1lbnQgPT4ge1xyXG5cdFx0XHRlbGVtZW50LmlubmVyVGV4dCA9IHRoaXMucm91bmRXaW5zQnlQbGF5ZXJbYHBsYXllciR7dGhpcy5wbGF5ZXJ9YF07XHJcblx0XHR9KTtcclxuXHR9XHJcblxyXG5cdHRpbWVDb3VudGVyKCkge1xyXG5cdFx0bGV0IGhvdXJzID0gTWF0aC5mbG9vcih0aGlzLmN1cnJlbnRUaW1lU3BlbnQgLyAzNjAwKSxcclxuXHRcdFx0bWludXRlcyA9IE1hdGguZmxvb3IoKHRoaXMuY3VycmVudFRpbWVTcGVudCAtIChob3VycyAqIDM2MDApKSAvIDYwKSxcclxuXHRcdFx0c2Vjb25kcyA9IHRoaXMuY3VycmVudFRpbWVTcGVudCAtIChob3VycyAqIDM2MDApIC0gKG1pbnV0ZXMgKiA2MCk7XHJcblxyXG5cdFx0aWYgKGhvdXJzIDwgMTApIHtcclxuXHRcdFx0aG91cnMgPSBcIjBcIiArIGhvdXJzO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmIChtaW51dGVzIDwgMTApIHtcclxuXHRcdFx0bWludXRlcyA9IFwiMFwiICsgbWludXRlcztcclxuXHRcdH1cclxuXHJcblx0XHRpZiAoc2Vjb25kcyA8IDEwKSB7XHJcblx0XHRcdHNlY29uZHMgPSBcIjBcIiArIHNlY29uZHM7XHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuIGhvdXJzICsgXCI6XCIgKyBtaW51dGVzICsgXCI6XCIgKyBzZWNvbmRzO1xyXG5cdH1cclxuXHJcblx0Y2xvY2soKSB7XHJcblx0XHR0aGlzLmNsb2NrSWQgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XHJcblx0XHRcdGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ1tkYXRhLXRpbWUtY291bnRlcl0nKS5mb3JFYWNoKGVsZW1lbnQgPT4ge1xyXG5cdFx0XHRcdGVsZW1lbnQuaW5uZXJUZXh0ID0gdGhpcy50aW1lQ291bnRlcigpO1xyXG5cdFx0XHR9KTtcclxuXHRcdFxyXG5cdFx0XHR0aGlzLmN1cnJlbnRUaW1lU3BlbnQrKztcclxuXHRcdH0sIDEwMDApO1xyXG5cdH1cclxuXHJcblx0dGltZUFjY3VtdWxhdG9yKHRvQWRkID0gJzAwOjAwOjAwJykge1xyXG5cclxuXHRcdGlmICgvXFxkezJ9OlxcZHsyfTpcXGR7Mn0vLnRlc3QodG9BZGQpKSB7XHJcblx0XHRcdGxldCB0aW1lID0gWycwMCcsICcwMCcsICcwMCddLFxyXG4gIFx0XHRcdFx0YWRkaXRpb24gPSB0b0FkZC5zcGxpdCgnOicpLFxyXG5cdFx0XHRcdGFjYyA9IHRoaXMuc3RhdGlzdGljcy5hZ2dyZWdhdGVkVGltZS5zcGxpdCgnOicpLFxyXG5cdFx0XHRcdHNlY29uZHMgPSArYWRkaXRpb25bMl0gKyAoK2FjY1syXSksXHJcblx0XHRcdFx0bWludXRlcyA9ICthZGRpdGlvblsxXSArICgrYWNjWzFdKSxcclxuXHRcdFx0XHRob3VycyA9ICthZGRpdGlvblswXSArICgrYWNjWzBdKTtcclxuICAgICAgXHJcbiAgICAgIFxyXG5cdFx0XHRpZiAoc2Vjb25kcyA+PSA2MCkge1xyXG5cdFx0XHRcdGxldCBtID0gKHNlY29uZHMgLyA2MCkgPDwgMDtcclxuXHRcdFx0XHRtaW51dGVzICs9IG07XHJcblx0XHRcdFx0c2Vjb25kcyAtPSA2MCAqIG07XHJcblx0XHRcdH1cclxuICAgICAgXHJcblx0XHRcdGlmIChtaW51dGVzID49NjApIHtcclxuXHRcdFx0XHRsZXQgaCA9IChtaW51dGVzIC8gNjApIDw8IDA7XHJcblx0XHRcdFx0aG91cnMgKz0gaDtcclxuXHRcdFx0XHRtaW51dGVzIC09IDYwICogaDtcclxuXHRcdFx0fVxyXG4gICAgICBcclxuXHRcdFx0dGltZVswXSA9IGhvdXJzIDwgMTAgPyAnMCcgKyBob3VycyA6IGhvdXJzLnRvU3RyaW5nKCk7XHJcblx0XHRcdHRpbWVbMV0gPSBtaW51dGVzIDwgMTAgPyAnMCcgKyBtaW51dGVzIDogbWludXRlcy50b1N0cmluZygpO1xyXG5cdFx0XHR0aW1lWzJdID0gc2Vjb25kcyA8IDEwID8gJzAnICsgc2Vjb25kcyA6IHNlY29uZHMudG9TdHJpbmcoKTtcclxuXHJcblx0XHRcdHJldHVybiB0aW1lLmpvaW4oJzonKTtcclxuXHRcdH1cclxuXHJcblxyXG5cdFx0cmV0dXJuIHRoaXMuc3RhdGlzdGljcy5hZ2dyZWdhdGVkVGltZTtcclxuXHR9XHJcblxyXG5cdHJlc3RhcnRHYW1lKCkge1xyXG4gICAgICAgIHRoaXMucGxheWVyID0gJzEnO1xyXG4gICAgICAgIHRoaXMuYm9hcmRTdGF0dXMuZmlsbCgnJyk7XHJcblxyXG4gICAgICAgIGxldCBib2FyZENlbGxzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmZsZXgtaXRlbScpLFxyXG4gICAgICAgICAgICBib2FyZENlbGxzTGVuZ3RoID0gYm9hcmRDZWxscy5sZW5ndGgsXHJcbiAgICAgICAgICAgIGFwcGxpZWRDbGFzc2VzID0gWydwbGF5ZXIxJywgJ3BsYXllcjInLCAncGxheWVyMVdpbicsICdwbGF5ZXIyV2luJywgJ3dpbm5pbmctY2VsbCddO1xyXG5cclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGJvYXJkQ2VsbHNMZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBib2FyZENlbGxzW2ldLmNsYXNzTGlzdC5yZW1vdmUoLi4uYXBwbGllZENsYXNzZXMpO1xyXG4gICAgICAgIH1cclxuXHJcblx0XHR0aGlzLmhpZ2hsaWdodFNlbGVjdGVkUGxheWVyKHRydWUpO1xyXG4gICAgfVxyXG5cclxuXHR0cmlnZ2VyUG9wdXAobWVzc2FnZSA9ICcnKSB7XHJcblx0XHRsZXQgY2xvc2UgPSAoKSA9PiB7XHJcblx0XHRcdGxldCBtb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtZXNzYWdlJyk7XHJcblx0XHRcdGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtb2RhbC1jbG9zZScpLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY2xvc2UpO1xyXG5cdFx0XHRkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKG1vZGFsKTtcclxuXHRcdH07XHJcblxyXG5cdFx0bGV0IGRpYWxvZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xyXG5cdFx0ZGlhbG9nLmlkID0gJ21lc3NhZ2UnO1xyXG5cdFx0ZGlhbG9nLmNsYXNzTGlzdC5hZGQoJ21vZGFsJyk7XHJcblx0XHRkaWFsb2cuaW5uZXJIVE1MID0gYFxyXG5cdFx0PGRpdiBjbGFzcz1cIm1vZGFsLWNvbnRlbnRcIj5cclxuXHRcdFx0PGRpdiBpZD1cIm1vZGFsLWNsb3NlXCIgY2xhc3M9XCJjbG9zZVwiPiZ0aW1lczs8L2Rpdj5cclxuXHRcdFx0PGgxPldpbm5lciEhITwvaDE+XHJcblx0XHRcdDxkaXYgY2xhc3M9XCJib2R5XCI+XHJcblx0XHRcdFx0Q29uZ3JhdHMgJHttZXNzYWdlfSEhIVxyXG5cdFx0XHQ8L2Rpdj5cclxuXHRcdDwvZGl2PlxyXG5cdFx0YDtcclxuXHJcblx0XHRkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGRpYWxvZyk7XHJcblx0XHRzZXRUaW1lb3V0KCgpID0+IHtcclxuXHRcdFx0ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJtb2RhbC1jbG9zZVwiKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGNsb3NlKTtcclxuXHRcdH0pO1xyXG5cdH1cclxuXHJcblx0dXBkYXRlU3RhdGlzdGljcyhpc0luaXRpYWxpemF0aW9uID0gdHJ1ZSkge1xyXG5cdFx0aWYgKHRoaXMuc3RhdGlzdGljcy50b3RhbEdhbWVzUGxheWVkKSB7XHJcblx0XHRcdGxldCBwbGF5ZXIxV2lucyA9IE1hdGgucm91bmQodGhpcy5zdGF0aXN0aWNzLnBsYXllcjFXaW5zL3RoaXMuc3RhdGlzdGljcy50b3RhbEdhbWVzUGxheWVkICogMTAwKSxcclxuXHRcdFx0XHRwbGF5ZXIyV2lucyA9IE1hdGgucm91bmQodGhpcy5zdGF0aXN0aWNzLnBsYXllcjJXaW5zL3RoaXMuc3RhdGlzdGljcy50b3RhbEdhbWVzUGxheWVkICogMTAwKTtcclxuXHJcblxyXG5cdFx0XHRkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncDFXJykuaW5uZXJUZXh0ID0gcGxheWVyMVdpbnMgKyAnJSc7XHJcblx0XHRcdGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwMUwnKS5pbm5lclRleHQgPSAoMTAwIC0gcGxheWVyMVdpbnMpICsgJyUnO1xyXG5cdFx0XHRkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncDJXJykuaW5uZXJUZXh0ID0gcGxheWVyMldpbnMgKyAnJSc7XHJcblx0XHRcdGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwMkwnKS5pbm5lclRleHQgPSAoMTAwIC0gcGxheWVyMldpbnMpICsgJyUnO1xyXG5cclxuXHRcdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLnN0YXRpc3RpY3MudG90YWxHYW1lc1BsYXllZCAmJiBpIDwgOTsgaSsrKSB7XHJcblx0XHRcdFx0ZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgW2RhdGEtcGxheWVkLW1hdGNoZXM9XCIke2l9XCJdYCkuY2xhc3NMaXN0LmFkZCgncGxheWVkJyk7XHJcblx0XHRcdFx0ZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgW2RhdGEtZ2FtZS1oaXN0b3J5PVwiJHtpfVwiXWApLmlubmVyVGV4dCA9IHRoaXMuc3RhdGlzdGljcy5oaXN0b3J5W2ldO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRpZiAodGhpcy5zdGF0aXN0aWNzLnRvdGFsR2FtZXNQbGF5ZWQgPiA5KSB7XHJcblx0XHRcdFx0ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2V4dHJhJykuaW5uZXJUZXh0ID0gJysgJyArICh0aGlzLnN0YXRpc3RpY3MudG90YWxHYW1lc1BsYXllZCAtIDkpO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRsZXQgYWdncmVnYXRlZFRpbWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYWdyZWdnYXRlZC10aW1lJyk7XHJcblx0XHRcdGlzSW5pdGlhbGl6YXRpb24gPyBhZ2dyZWdhdGVkVGltZS5pbm5lclRleHQgPSB0aGlzLnN0YXRpc3RpY3MuYWdncmVnYXRlZFRpbWUgOiBhZ2dyZWdhdGVkVGltZS5pbm5lclRleHQgPSB0aGlzLnRpbWVBY2N1bXVsYXRvcih0aGlzLnRpbWVDb3VudGVyKCkpO1xyXG5cclxuXHRcdH1cclxuXHR9XHJcbn1cclxuIiwiaW1wb3J0IHtTd29yZEdhbWVzfSBmcm9tICcuL3N3b3JkZ2FtZXMnO1xyXG5cclxuZXhwb3J0IGNsYXNzIFRpY1RhY1RvZSBleHRlbmRzIFN3b3JkR2FtZXMge1xyXG4gICAgY29uc3RydWN0b3IoYm9hcmRTaXplID0gMykge1xyXG4gICAgICAgIHN1cGVyKCk7XHJcbiAgICAgICAgdGhpcy5ib2FyZFNpemUgPSBib2FyZFNpemU7XHJcbiAgICB9XHJcblxyXG4gICAgb25Jbml0KCkge1xyXG4gICAgICAgIHRoaXMud2lubmluZ0NvbmRpdGlvbnMgPSBBcnJheS5mcm9tKHtcclxuICAgICAgICAgICAgbGVuZ3RoOiAodGhpcy5ib2FyZFNpemUgKiAyKSArIDJcclxuICAgICAgICB9LCAoKSA9PiAobmV3IEFycmF5KHRoaXMuYm9hcmRTaXplKSkpO1xyXG5cclxuICAgICAgICB0aGlzLmJvYXJkU3RhdHVzID0gbmV3IEFycmF5KHRoaXMuYm9hcmRTaXplICogdGhpcy5ib2FyZFNpemUpLmZpbGwoJycpO1xyXG5cclxuICAgICAgICB0aGlzLmJ1aWxkUm93cygpO1xyXG4gICAgICAgIHRoaXMuYnVpbGRDb2xzKCk7XHJcbiAgICAgICAgdGhpcy5idWlsZEx0ckRpYWcoKTtcclxuICAgICAgICB0aGlzLmJ1aWxkUnRyRGlhZygpO1xyXG5cclxuICAgICAgICB0aGlzLmJ1aWxkQm9hcmQoKTtcclxuXHJcbiAgICAgICAgdGhpcy5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuICAgICAgICBzdXBlci5oaWdobGlnaHRTZWxlY3RlZFBsYXllcih0cnVlKTtcclxuICAgICAgICB0aGlzLmNsb2NrKCk7XHJcblxyXG4gICAgICAgIHRoaXMudXBkYXRlU3RhdGlzdGljcygpO1xyXG4gICAgfVxyXG5cclxuICAgIGJ1aWxkUm93cygpIHtcclxuICAgICAgICBsZXQgcm93QWNjdW11bGF0b3IgPSAtMTtcclxuICAgICAgICBmb3IgKGxldCByb3cgPSAwOyByb3cgPCB0aGlzLmJvYXJkU2l6ZTsgcm93KyspIHtcclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmJvYXJkU2l6ZTsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICArK3Jvd0FjY3VtdWxhdG9yO1xyXG4gICAgICAgICAgICAgICAgdGhpcy53aW5uaW5nQ29uZGl0aW9uc1tyb3ddW2ldID0gcm93QWNjdW11bGF0b3I7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgYnVpbGRDb2xzKCkge1xyXG4gICAgICAgIGxldCBjb2xBY2N1bXVsYXRvciA9IC0xLFxyXG4gICAgICAgICAgICB3aW5uaW5nQ29uZGl0aW9uc0xlbmd0aCA9IHRoaXMud2lubmluZ0NvbmRpdGlvbnMubGVuZ3RoO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5ib2FyZFNpemU7IGkrKykge1xyXG4gICAgICAgICAgICBmb3IgKGxldCBjb2wgPSB0aGlzLmJvYXJkU2l6ZTsgY29sIDw9IHdpbm5pbmdDb25kaXRpb25zTGVuZ3RoIC0gMzsgY29sKyspIHtcclxuICAgICAgICAgICAgICAgICsrY29sQWNjdW11bGF0b3I7XHJcbiAgICAgICAgICAgICAgICB0aGlzLndpbm5pbmdDb25kaXRpb25zW2NvbF1baV0gPSBjb2xBY2N1bXVsYXRvcjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBidWlsZEx0ckRpYWcoKSB7XHJcbiAgICAgICAgbGV0IHdpbm5pbmdDb25kaXRpb25zTGVuZ3RoID0gdGhpcy53aW5uaW5nQ29uZGl0aW9ucy5sZW5ndGg7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmJvYXJkU2l6ZTsgaSsrKSB7XHJcbiAgICAgICAgICAgIHRoaXMud2lubmluZ0NvbmRpdGlvbnNbd2lubmluZ0NvbmRpdGlvbnNMZW5ndGggLSAyXVtpXSA9IGkgKiAodGhpcy5ib2FyZFNpemUgKyAxKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgYnVpbGRSdHJEaWFnKCkge1xyXG4gICAgICAgIGxldCBhID0gdGhpcy5ib2FyZFNpemUgLSAxLFxyXG4gICAgICAgICAgICB3aW5uaW5nQ29uZGl0aW9uc0xlbmd0aCA9IHRoaXMud2lubmluZ0NvbmRpdGlvbnMubGVuZ3RoO1xyXG5cdCAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuYm9hcmRTaXplOyBpKyspIHtcclxuICBcdCAgICAgICAgdGhpcy53aW5uaW5nQ29uZGl0aW9uc1t3aW5uaW5nQ29uZGl0aW9uc0xlbmd0aCAtIDFdW2ldID0gKGkgKiBhKSArIGE7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGJ1aWxkQm9hcmQoKSB7XHJcbiAgICAgICAgbGV0IGJvYXJkQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2JvYXJkJyksXHJcbiAgICAgICAgICAgIGJvYXJkID0gJycsXHJcbiAgICAgICAgICAgIGNvdW50ZXIgPSAtMTtcclxuXHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmJvYXJkU2l6ZTsgaSsrKSB7XHJcbiAgICAgICAgICAgIGJvYXJkICs9ICc8ZGl2IGNsYXNzPVwiZmxleC1jb250YWluZXJcIj4nO1xyXG4gICAgICAgICAgICBmb3IobGV0IGogPSAwOyBqIDwgdGhpcy5ib2FyZFNpemU7IGorKykge1xyXG4gICAgICAgICAgICAgICAgKytjb3VudGVyO1xyXG4gICAgICAgICAgICAgICAgYm9hcmQgKz0gYDxkaXYgY2xhc3M9XCJmbGV4LWl0ZW1cIiBkYXRhLWNlbGwtaWQ9XCIke2NvdW50ZXJ9XCI+PC9kaXY+YDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBib2FyZCArPSAnPC9kaXY+JztcclxuICAgICAgICB9XHJcbiAgICAgICAgYm9hcmRDb250YWluZXIuaW5uZXJIVE1MID0gYm9hcmQ7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAgICAgbGV0IGJvYXJkQ2VsbHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZmxleC1pdGVtJyksXHJcbiAgICAgICAgICAgIGJvYXJkQ2VsbHNMZW5ndGggPSBib2FyZENlbGxzLmxlbmd0aDtcclxuXHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBib2FyZENlbGxzTGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgYm9hcmRDZWxsc1tpXS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMub25DZWxsQ2xpY2tlZC5iaW5kKHRoaXMpKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBNYW5hZ2UgYm9hcmQgY2VsbCBjbGlja3MuIElmIGNlbGwgYWxyZWFkeSBjbGlja2VkIGRvbnQgYWxsb3cgYSBtb3ZlIG9uIHRoYXQgY2VsbFxyXG4gICAgICogQHBhcmFtIHtvYmplY3R9IGV2IFxyXG4gICAgICogQHJldHVybnMgXHJcbiAgICAgKi9cclxuICAgIG9uQ2VsbENsaWNrZWQoZXYpIHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBsZXQgY2xpY2tlZENlbGwgPSArZXYudGFyZ2V0LmRhdGFzZXQuY2VsbElkO1xyXG4gICAgICAgICAgICBjb25zb2xlLmRlYnVnKCdvbiBjZWxsIGNsaWNrZWQnLCB0aGlzLmRhdGFzZXQpO1xyXG5cclxuICAgICAgICAgICAgLy8gY2tlY2sgaWYgY2VsbCBpcyBhdmFpbGFibGVcclxuICAgICAgICAgICAgaWYgKHRoaXMuYm9hcmRTdGF0dXNbY2xpY2tlZENlbGxdICE9PSAnJykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0aGlzLmNlbGxQbGF5ZWRIYW5kbGVyKGV2LnRhcmdldCwgY2xpY2tlZENlbGwpO1xyXG4gICAgICAgIH0gY2F0Y2goZSkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGUpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFxyXG4gICAgICogQHBhcmFtIHtvYmplY3R9IGNlbGwgXHJcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gY2VsbEluZGV4IFxyXG4gICAgICovXHJcbiAgICBjZWxsUGxheWVkSGFuZGxlcihjZWxsID0gbnVsbCwgY2VsbEluZGV4ID0gLTEpIHtcclxuICAgICAgICBpZiAoIWNlbGwgfHwgY2VsbEluZGV4ID09PSAtMSkge1xyXG4gICAgICAgICAgICB0aHJvdygnSW52YWxpZENlbGxFeGNlcHRpb24nKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNlbGwuY2xhc3NMaXN0LmFkZCh0aGlzLnBsYXllciA9PT0gJzEnID8gJ3BsYXllcjEnIDogJ3BsYXllcjInKTtcclxuICAgICAgICB0aGlzLmJvYXJkU3RhdHVzW2NlbGxJbmRleF0gPSB0aGlzLnBsYXllcjtcclxuICAgICAgICB0aGlzLmNoZWNrV2luKCk7XHJcbiAgICB9XHJcblxyXG4gICAgY2hlY2tXaW4oKSB7XHJcblxyXG4gICAgICAgIGxldCB2aWN0b3J5ID0gZmFsc2UsXHJcbiAgICAgICAgICAgIGRyYXcgPSBmYWxzZSxcclxuICAgICAgICAgICAgd2lubmluZ0NvbmRpdGlvbnNMZW5ndGggPSB0aGlzLndpbm5pbmdDb25kaXRpb25zLmxlbmd0aCxcclxuICAgICAgICAgICAgd2lubmluZ0NvbmRpdGlvbiA9IG51bGw7XHJcblxyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgd2lubmluZ0NvbmRpdGlvbnNMZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICB3aW5uaW5nQ29uZGl0aW9uID0gdGhpcy53aW5uaW5nQ29uZGl0aW9uc1tpXTtcclxuXHJcbiAgICAgICAgICAgIGxldCB0ZXN0ID0gW107XHJcblxyXG4gICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHRoaXMuYm9hcmRTaXplOyBqKyspIHtcclxuICAgICAgICAgICAgICAgIHRlc3QucHVzaCh0aGlzLmJvYXJkU3RhdHVzW3dpbm5pbmdDb25kaXRpb25bal1dKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKHRlc3Quc29tZShlbGVtID0+IHtyZXR1cm4gZWxlbSA9PT0gJyc7fSkpIHtcclxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAodGVzdC5ldmVyeShlbGVtID0+IGVsZW0gPT09IHRlc3RbMF0pKSB7XHJcbiAgICAgICAgICAgICAgICB2aWN0b3J5ID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIGlmICh2aWN0b3J5KSB7XHJcbiAgICAgICAgICAgIC8vIGhpZ2hsaWdodCBsaW5lXHJcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5ib2FyZFNpemU7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgbGV0IGNlbGxJZCA9IHdpbm5pbmdDb25kaXRpb25baV0sXHJcbiAgICAgICAgICAgICAgICAgICAgYm9hcmRDZWxsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgW2RhdGEtY2VsbC1pZD1cIiR7Y2VsbElkfVwiXWApO1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICBib2FyZENlbGwuY2xhc3NMaXN0LmFkZChgcGxheWVyJHt0aGlzLnBsYXllcn1XaW5gLCAnd2lubmluZy1jZWxsJyk7XHJcbiAgICAgICAgICAgICAgICBib2FyZENlbGwuY2xhc3NMaXN0LnJlbW92ZShgcGxheWVyJHt0aGlzLnBsYXllcn1gKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnJlc3RhcnRHYW1lKCk7XHJcbiAgICAgICAgICAgIH0sIDQwMDApO1xyXG5cclxuXHJcbiAgICAgICAgICAgIHRoaXMucm91bmRXaW5zQnlQbGF5ZXJbJ3BsYXllcicrdGhpcy5wbGF5ZXJdICs9IDE7XHJcbiAgICAgICAgICAgIC8vIHVwZGF0ZSBwbGF5ZXIgY291bnRcclxuICAgICAgICAgICAgdGhpcy51cGRhdGVQbGF5ZXJDb3VudCgpO1xyXG5cclxuICAgICAgICAgICAgLy8gZmlyc3QgcGxheWVyIHRvIGdldCA1IHJvdW5kcyBpcyB0ZSB3aW5uZXJcclxuICAgICAgICAgICAgaWYgKHRoaXMucm91bmRXaW5zQnlQbGF5ZXIucGxheWVyMSA9PT0gNSB8fCB0aGlzLnJvdW5kV2luc0J5UGxheWVyLnBsYXllcjIgPT09IDUpIHtcclxuICAgICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy5jbG9ja0lkKTtcclxuXHJcbiAgICAgICAgICAgICAgICBsZXQgcGxheWVyVmljdG9yaW91cyA9IHRoaXMucm91bmRXaW5zQnlQbGF5ZXIucGxheWVyMSA9PT0gNSA/IDEgOiAyO1xyXG4gICAgICAgICAgICAgICAgLy8gZGlzcGxheSBjb25ncmF0cyBtZXNzYWdlIGFuZCBzY3JvbGwgdG8gbmV4dCBzZWN0aW9uXHJcbiAgICAgICAgICAgICAgICBzdXBlci50cmlnZ2VyUG9wdXAocGxheWVyVmljdG9yaW91cyA9PT0gMSA/ICdwbGF5ZXIxJyA6ICdwbGF5ZXIyJyk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy9yZXNldCB0aW1lIGNvdW50ZXJzXHJcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdbZGF0YS10aW1lLWNvdW50ZXJdJykuZm9yRWFjaChlbGVtZW50ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBlbGVtZW50LmlubmVyVGV4dCA9IHRoaXMudGltZUNvdW50ZXIoKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ1tkYXRhLXBsYXllci1jb3VudC1pZF0nKS5mb3JFYWNoKGVsZW1lbnQgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuaW5uZXJUZXh0ID0gMDtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIGhpZGUgZ2FtZSBhcmVhXHJcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdbZGF0YS1nYW1lLWFyZWFdJykuZm9yRWFjaChlbGVtZW50ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBlbGVtZW50LnN0eWxlLnZpc2liaWxpdHkgPSAnaGlkZGVuJztcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0aW1lLWNvdW50ZXInKS5zdHlsZS52aXNpYmlsaXR5ID0gJ2hpZGRlbic7XHJcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYm9hcmQnKS5pbm5lckhUTUwgPSAnJztcclxuXHJcbiAgICAgICAgICAgICAgICBsZXQgZ3JpZFNpemVTZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2VsZWN0LWdyaWQtc2l6ZScpO1xyXG4gICAgICAgICAgICAgICAgZ3JpZFNpemVTZWxlY3QudmFsdWUgPSAnLS0tJztcclxuICAgICAgICAgICAgICAgIGdyaWRTaXplU2VsZWN0LnJlbW92ZUF0dHJpYnV0ZSgnZGlzYWJsZWQnKTtcclxuXHJcblxyXG4gICAgICAgICAgICAgICAgdGhpcy5zdGF0aXN0aWNzLnRvdGFsR2FtZXNQbGF5ZWQgKz0gMTtcclxuICAgICAgICAgICAgICAgIGxldCBoaXN0b3J5TGVuZ3RoID0gdGhpcy5zdGF0aXN0aWNzLmhpc3RvcnkubGVuZ3RoO1xyXG4gICAgICAgICAgICAgICAgaGlzdG9yeUxlbmd0aCA8IDkgPyB0aGlzLnN0YXRpc3RpY3MuaGlzdG9yeS5wdXNoKHBsYXllclZpY3RvcmlvdXMgPT09IDEgPyAnUDEnIDogJ1AyJykgOiB0aGlzLnN0YXRpc3RpY3MuaGlzdG9yeVtoaXN0b3J5TGVuZ3RoIC0gMV0gPSAocGxheWVyVmljdG9yaW91cyA9PT0gMSA/ICdQMScgOiAnUDInKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc3RhdGlzdGljcy5hZ2dyZWdhdGVkVGltZSA9IHRoaXMudGltZUFjY3VtdWxhdG9yKHRoaXMudGltZUNvdW50ZXIoKSk7XHJcbiAgICAgICAgICAgICAgICBpZiAocGxheWVyVmljdG9yaW91cyA9PT0gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3RhdGlzdGljcy5wbGF5ZXIxV2lucyArPSAxO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YXRpc3RpY3MucGxheWVyMldpbnMgKz0gMTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAvLyByZXNldCBldmVyeXRoaW5nXHJcbiAgICAgICAgICAgICAgICB0aGlzLnJvdW5kV2luc0J5UGxheWVyLnBsYXllcjEgPSAwO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5yb3VuZFdpbnNCeVBsYXllci5wbGF5ZXIyID0gMDtcclxuXHRcdCAgICAgICAgdGhpcy5ib2FyZFN0YXR1cy5sZW5ndGggPSAwO1xyXG4gICAgICAgICAgICAgICAgdGhpcy53aW5uaW5nQ29uZGl0aW9ucy5sZW5ndGggPSAwO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50VGltZVNwZW50ID0gMDtcclxuICAgICAgICAgICAgICAgIHRoaXMub25EZXN0cm95KCk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gdXBkYXRlIHN0YXRpc3RpY3NcclxuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlU3RhdGlzdGljcyhmYWxzZSk7XHJcblxyXG4gICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3N0YXRzJywgSlNPTi5zdHJpbmdpZnkodGhpcy5zdGF0aXN0aWNzKSk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gc2Nyb2xsXHJcbiAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdzdGF0aXN0aWNzLWNvbnRhaW5lcicpWzBdLnNjcm9sbEludG9WaWV3KHtiZWhhdmlvcjogJ3Ntb290aCcsIGJsb2NrOiAnY2VudGVyJ30pO1xyXG5cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gYXJyaXZpbmcgaGVyZSBubyB2aWN0b3J5IGZvdW5kLiBpdCBpcyBhIGRyYXcgaWYgYWxsIGNlbGxzIGFyZSBmaWxsZWRcclxuICAgICAgICBkcmF3ID0gIXRoaXMuYm9hcmRTdGF0dXMuaW5jbHVkZXMoJycpO1xyXG4gICAgICAgIGlmIChkcmF3KSB7XHJcbiAgICAgICAgICAgIC8vIGNsZWFyIGJvYXJkIGFuZCBzdGFydCBhZ2FpblxyXG4gICAgICAgICAgICB0aGlzLnJlc3RhcnRHYW1lKCk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMubWFuYWdlUGxheWVyQ2hhbmdlKCk7XHJcbiAgICB9XHJcblxyXG4gICAgbWFuYWdlUGxheWVyQ2hhbmdlKCkge1xyXG4gICAgICAgIHRoaXMucGxheWVyID0gdGhpcy5wbGF5ZXIgPT09ICcxJyA/ICcyJyA6ICcxJztcclxuICAgICAgICBzdXBlci5oaWdobGlnaHRTZWxlY3RlZFBsYXllcigpO1xyXG4gICAgfVxyXG59XHJcbiIsIi8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb25zIGZvciBoYXJtb255IGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uZCA9IChleHBvcnRzLCBkZWZpbml0aW9uKSA9PiB7XG5cdGZvcih2YXIga2V5IGluIGRlZmluaXRpb24pIHtcblx0XHRpZihfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZGVmaW5pdGlvbiwga2V5KSAmJiAhX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIGtleSkpIHtcblx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBrZXksIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBkZWZpbml0aW9uW2tleV0gfSk7XG5cdFx0fVxuXHR9XG59OyIsIl9fd2VicGFja19yZXF1aXJlX18ubyA9IChvYmosIHByb3ApID0+IChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKSkiLCIvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSAoZXhwb3J0cykgPT4ge1xuXHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcblx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcblx0fVxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xufTsiLCIvLyBzdGFydHVwXG4vLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18oXCIuL3NyYy9pbmRleC5qc1wiKTtcbi8vIFRoaXMgZW50cnkgbW9kdWxlIGlzIHJlZmVyZW5jZWQgYnkgb3RoZXIgbW9kdWxlcyBzbyBpdCBjYW4ndCBiZSBpbmxpbmVkXG52YXIgX193ZWJwYWNrX2V4cG9ydHNfXyA9IF9fd2VicGFja19yZXF1aXJlX18oXCIuL3NyYy9zYXNzL21haW4uc2Nzc1wiKTtcbiJdLCJzb3VyY2VSb290IjoiIn0=