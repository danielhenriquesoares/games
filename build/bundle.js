(()=>{"use strict";function a(d){var e=c[d];if(void 0!==e)return e.exports;var f=c[d]={exports:{}};return b[d](f,f.exports,a),f.exports}var b={"./src/index.js":/*!**********************!*\
  !*** ./src/index.js ***!
  \**********************/(a,b,c)=>{c.r(b);var d=c(/*! ./tictactoe */"./src/tictactoe.js"),e=c(/*! ./sass/main.scss */"./src/sass/main.scss");(function(){console.debug("hello webpack"),window.addEventListener("scroll",function(){document.querySelector("header").style.opacity=document.documentElement.scrollTop>150?0:1,console.debug(document.documentElement.scrollTop)});var a=document.getElementById("sword-logo"),b=document.getElementById("facebook"),c=document.getElementById("twitter"),e=document.getElementById("instagram"),f=document.getElementById("send");a.src=".assets/img/SWORD_Health_logo.svg",b.src=".assets/img/facebook.svg",c.src=".assets/img/twitter.svg",e.src=".assets/img/instagram.svg",f.src=".assets/img/send.svg";var g=document.getElementById("select-grid-size");g.addEventListener("change",function(a){console.debug(a.target.value);try{document.getElementById("game-area").style.visibility="visible";var b=new d.TicTacToe(+a.target.value);b.onInit()}catch(a){console.error(a)}})}).call()},"./src/swordgames.js":/*!***************************!*\
  !*** ./src/swordgames.js ***!
  \***************************/(a,b,c)=>{function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function f(a,b,c){return b&&e(a.prototype,b),c&&e(a,c),a}c.r(b),c.d(b,{SwordGames:()=>g});var g=function(){function a(){d(this,a),this.game="tictactoe",this.player="1",this.boardStatus=[],this.winningConditions=[]}return f(a,[{key:"onInit",value:function(){throw"NotImplementedException"}},{key:"buildBoard",value:function(){throw"NotImplementedException"}},{key:"setEventListeners",value:function(){throw"NotImplementedException"}},{key:"onDestroy",value:function(){if("tictactoe"===this.game)for(var a=document.querySelectorAll(".flex-item"),b=a.length,c=0;c<b;c++)a[c].removeEventListener(this.onCellClicked)}}]),a}()},"./src/tictactoe.js":/*!**************************!*\
  !*** ./src/tictactoe.js ***!
  \**************************/(a,b,c)=>{function d(a){"@babel/helpers - typeof";return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},d(a)}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function f(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function g(a,b,c){return b&&f(a.prototype,b),c&&f(a,c),a}function h(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),b&&i(a,b)}function i(a,b){return i=Object.setPrototypeOf||function(a,b){return a.__proto__=b,a},i(a,b)}function j(a){var b=m();return function(){var c,d=n(a);if(b){var e=n(this).constructor;c=Reflect.construct(d,arguments,e)}else c=d.apply(this,arguments);return k(this,c)}}function k(a,b){return b&&("object"===d(b)||"function"==typeof b)?b:l(a)}function l(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function m(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}function n(a){return n=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)},n(a)}c.r(b),c.d(b,{TicTacToe:()=>p});var o=c(/*! ./swordgames */"./src/swordgames.js"),p=function(a){function b(){var a,d=0<arguments.length&&void 0!==arguments[0]?arguments[0]:3;return e(this,b),a=c.call(this),a.boardSize=d,a.roundWinsByPlayer={player1:0,player2:0},a}h(b,a);var c=j(b);return g(b,[{key:"onInit",value:function(){var a=this;this.winningConditions=Array.from({length:2*this.boardSize+2},function(){return Array(a.boardSize)}),this.boardStatus=Array(this.boardSize*this.boardSize).fill(""),this.buildRows(),this.buildCols(),this.buildLtrDiag(),this.buildRtrDiag(),console.debug(this.winningConditions,this.boardSize),this.buildBoard(),this.setEventListeners()}},{key:"buildRows",value:function(){for(var a=-1,b=0;b<this.boardSize;b++)for(var c=0;c<this.boardSize;c++)++a,this.winningConditions[b][c]=a}},{key:"buildCols",value:function(){for(var a=-1,b=this.winningConditions.length,c=0;c<this.boardSize;c++)for(var d=this.boardSize;d<=b-3;d++)++a,this.winningConditions[d][c]=a}},{key:"buildLtrDiag",value:function(){for(var a=this.winningConditions.length,b=0;b<this.boardSize;b++)this.winningConditions[a-2][b]=b*(this.boardSize+1)}},{key:"buildRtrDiag",value:function(){for(var b=this.boardSize-1,a=this.winningConditions.length,c=0;c<this.boardSize;c++)this.winningConditions[a-1][c]=c*b+b}},{key:"buildBoard",value:function(){for(var a=document.querySelector("#board"),b="",c=-1,d=0;d<this.boardSize;d++){b+="<div class=\"flex-container\">";for(var e=0;e<this.boardSize;e++)++c,b+="<div class=\"flex-item\" data-cell-id=\"".concat(c,"\"></div>");b+="</div>"}a.innerHTML=b}},{key:"setEventListeners",value:function(){for(var a=document.querySelectorAll(".flex-item"),b=a.length,c=0;c<b;c++)a[c].addEventListener("click",this.onCellClicked.bind(this))}},{key:"onCellClicked",value:function(a){try{var b=+a.target.dataset.cellId;if(console.debug("on cell clicked",this.dataset),""!==this.boardStatus[b])return;this.cellPlayedHandler(a.target,b)}catch(a){console.error(a)}}},{key:"cellPlayedHandler",value:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:-1;if(!a||-1===b)throw"InvalidCellException";a.classList.add("1"===this.player?"player1":"player2"),this.boardStatus[b]=this.player,this.checkWin()}},{key:"checkWin",value:function(){for(var a,b=this,c=!1,d=!1,e=this.winningConditions.length,f=null,g=function(a){f=b.winningConditions[a];for(var d=[],e=0;e<b.boardSize;e++)d.push(b.boardStatus[f[e]]);return d.some(function(a){return""===a})?"continue":d.every(function(a){return a===d[0]})?(c=!0,"break"):void 0},h=0;h<e&&(a=g(h),"continue"===a||"break"!==a);h++);if(c){for(var i=0;i<this.boardSize;i++){var j=f[i],k=document.querySelector("[data-cell-id=\"".concat(j,"\"]"));k.classList.add("player".concat(this.player,"Win"),"winning-cell"),k.classList.remove("player".concat(this.player)),setTimeout(function(){b.restartGame()},4e3)}return this.roundWinsByPlayer["player"+this.player]+=1,void(5!==this.roundWinsByPlayer.player1&&5!==this.roundWinsByPlayer.player2)}return d=!this.boardStatus.includes(""),d?void this.restartGame():void this.managePlayerChange()}},{key:"managePlayerChange",value:function(){this.player="1"===this.player?"2":"1"}},{key:"restartGame",value:function(){this.player="1",this.boardStatus.fill("");for(var a=document.querySelectorAll(".flex-item"),b=a.length,c=["player1","player2","player1Win","player2Win","winning-cell"],d=0;d<b;d++){var e;(e=a[d].classList).remove.apply(e,c)}}}]),b}(o.SwordGames)},"./src/sass/main.scss":/*!****************************!*\
  !*** ./src/sass/main.scss ***!
  \****************************/(a,b,c)=>{c.r(b)}},c={};(()=>{a.d=(b,c)=>{for(var d in c)a.o(c,d)&&!a.o(b,d)&&Object.defineProperty(b,d,{enumerable:!0,get:c[d]})}})(),(()=>{a.o=(a,b)=>Object.prototype.hasOwnProperty.call(a,b)})(),(()=>{a.r=(a)=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})}})(),a("./src/index.js");a("./src/sass/main.scss")})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zd29yZGdhbWVzL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL3N3b3JkZ2FtZXMvLi9zcmMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vc3dvcmRnYW1lcy8uL3NyYy9zd29yZGdhbWVzLmpzIiwid2VicGFjazovL3N3b3JkZ2FtZXMvLi9zcmMvdGljdGFjdG9lLmpzIiwid2VicGFjazovL3N3b3JkZ2FtZXMvd2VicGFjay9ydW50aW1lL2RlZmluZSBwcm9wZXJ0eSBnZXR0ZXJzIiwid2VicGFjazovL3N3b3JkZ2FtZXMvd2VicGFjay9ydW50aW1lL2hhc093blByb3BlcnR5IHNob3J0aGFuZCIsIndlYnBhY2s6Ly9zd29yZGdhbWVzL3dlYnBhY2svcnVudGltZS9tYWtlIG5hbWVzcGFjZSBvYmplY3QiLCJ3ZWJwYWNrOi8vc3dvcmRnYW1lcy93ZWJwYWNrL3N0YXJ0dXAiXSwibmFtZXMiOlsiY29uc29sZSIsIndpbmRvdyIsImRvY3VtZW50IiwibG9nbyIsImZhY2Vib29rIiwidHdpdHRlciIsImluc3RhZ3JhbSIsInNlbmQiLCJncmlkU2l6ZSIsImV2IiwidGljVGFjVG9lIiwiVGljVGFjVG9lIiwiYm9hcmRDZWxscyIsImJvYXJkQ2VsbHNMZW5ndGgiLCJpIiwiYm9hcmRTaXplIiwicGxheWVyMSIsInBsYXllcjIiLCJsZW5ndGgiLCJyb3dBY2N1bXVsYXRvciIsInJvdyIsImNvbEFjY3VtdWxhdG9yIiwid2lubmluZ0NvbmRpdGlvbnNMZW5ndGgiLCJjb2wiLCJhIiwiYm9hcmRDb250YWluZXIiLCJib2FyZCIsImNvdW50ZXIiLCJqIiwiY2xpY2tlZENlbGwiLCJjZWxsIiwiY2VsbEluZGV4Iiwid2lubmluZ0NvbmRpdGlvbiIsInRlc3QiLCJlbGVtIiwidmljdG9yeSIsImNlbGxJZCIsImJvYXJkQ2VsbCIsInNldFRpbWVvdXQiLCJkcmF3IiwiYXBwbGllZENsYXNzZXMiLCJTd29yZEdhbWVzIl0sIm1hcHBpbmdzIjoibUJBSUEs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LFdDQ0EsVUFDQSw4Q0FEQSxFQUVBLDRDQUFzRCxjQUF0RCxFQUZBLENBSUEsc0NBQStDLFFBQS9DLEVBQ0EsQyxLQ0pBLG1CLENBRUEseUIiLCJmaWxlIjoiYnVuZGxlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLy8gVGhlIG1vZHVsZSBjYWNoZVxudmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9O1xuXG4vLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcblx0dmFyIGNhY2hlZE1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF07XG5cdGlmIChjYWNoZWRNb2R1bGUgIT09IHVuZGVmaW5lZCkge1xuXHRcdHJldHVybiBjYWNoZWRNb2R1bGUuZXhwb3J0cztcblx0fVxuXHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuXHR2YXIgbW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSA9IHtcblx0XHQvLyBubyBtb2R1bGUuaWQgbmVlZGVkXG5cdFx0Ly8gbm8gbW9kdWxlLmxvYWRlZCBuZWVkZWRcblx0XHRleHBvcnRzOiB7fVxuXHR9O1xuXG5cdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuXHRfX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXShtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuXHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuXHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG59XG5cbiIsImltcG9ydCB7VGljVGFjVG9lfSBmcm9tICcuL3RpY3RhY3RvZSc7XHJcbmltcG9ydCAnLi9zYXNzL21haW4uc2Nzcyc7XHJcbi8qIGltcG9ydCBzd29yZExvZ28gZnJvbSAnLi9pbWcvU1dPUkRfSGVhbHRoX2xvZ28uc3ZnJzsgKi9cclxuXHJcbihmdW5jdGlvbigpIHtcclxuICAgIFwidXNlIHN0cmljdFwiO1xyXG4gICAgY29uc29sZS5kZWJ1ZyhcImhlbGxvIHdlYnBhY2tcIik7XHJcblxyXG4gICAgLyogd2luZG93Lm9uc2Nyb2xsKGV2ID0+IHtcclxuICAgICAgICBsZXQgbGltaXQgPSAxNTA7XHJcblxyXG4gICAgICAgIGNvbnNvbGUuZGVidWcoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcCk7XHJcbiAgICB9KTsgKi9cclxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwic2Nyb2xsXCIsICgpID0+IHtcclxuICAgICAgICBsZXQgbGltaXQgPSAxNTA7XHJcblxyXG4gICAgICAgIGlmIChkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsVG9wID4gbGltaXQpIHtcclxuICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignaGVhZGVyJykuc3R5bGUub3BhY2l0eSA9IDA7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignaGVhZGVyJykuc3R5bGUub3BhY2l0eSA9IDE7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnNvbGUuZGVidWcoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBsZXQgbG9nbyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzd29yZC1sb2dvJyksXHJcbiAgICAgICAgZmFjZWJvb2sgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmFjZWJvb2snKSxcclxuICAgICAgICB0d2l0dGVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3R3aXR0ZXInKSxcclxuICAgICAgICBpbnN0YWdyYW0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW5zdGFncmFtJyksXHJcbiAgICAgICAgc2VuZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZW5kJyk7XHJcblxyXG4gICAgbG9nby5zcmMgPSAnLmFzc2V0cy9pbWcvU1dPUkRfSGVhbHRoX2xvZ28uc3ZnJztcclxuICAgIGZhY2Vib29rLnNyYyA9ICcuYXNzZXRzL2ltZy9mYWNlYm9vay5zdmcnO1xyXG4gICAgdHdpdHRlci5zcmMgPSAnLmFzc2V0cy9pbWcvdHdpdHRlci5zdmcnO1xyXG4gICAgaW5zdGFncmFtLnNyYyA9ICcuYXNzZXRzL2ltZy9pbnN0YWdyYW0uc3ZnJztcclxuICAgIHNlbmQuc3JjID0gJy5hc3NldHMvaW1nL3NlbmQuc3ZnJztcclxuXHJcbiAgICBsZXQgZ3JpZFNpemUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2VsZWN0LWdyaWQtc2l6ZScpO1xyXG4gICAgZ3JpZFNpemUuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgZXYgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUuZGVidWcoZXYudGFyZ2V0LnZhbHVlKTtcclxuXHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2dhbWUtYXJlYScpLnN0eWxlLnZpc2liaWxpdHkgPSAndmlzaWJsZSc7XHJcbiAgICAgICAgICAgIGxldCB0aWNUYWNUb2UgPSBuZXcgVGljVGFjVG9lKCtldi50YXJnZXQudmFsdWUpO1xyXG4gICAgICAgICAgICB0aWNUYWNUb2Uub25Jbml0KCk7XHJcbiAgICAgICAgfSBjYXRjaChlKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICBcclxufSkuY2FsbCgpO1xyXG4iLCJleHBvcnQgY2xhc3MgU3dvcmRHYW1lcyB7XHJcblx0Y29uc3RydWN0b3IoKSB7XHJcblx0XHR0aGlzLmdhbWUgPSBcInRpY3RhY3RvZVwiO1xyXG5cdFx0dGhpcy5wbGF5ZXIgPSAnMSc7XHJcblx0XHR0aGlzLmJvYXJkU3RhdHVzID0gW107XHJcblx0XHR0aGlzLndpbm5pbmdDb25kaXRpb25zID0gW107XHJcblx0XHQvKiB0aGlzLnN0YXRpc3RpY3MgPSB7XHJcblxyXG5cdFx0fSAqL1xyXG5cdH1cclxuXHJcblx0b25Jbml0KCkge1xyXG5cdFx0dGhyb3coJ05vdEltcGxlbWVudGVkRXhjZXB0aW9uJyk7XHRcclxuXHR9XHJcblxyXG5cdGJ1aWxkQm9hcmQoKSB7XHJcblx0XHR0aHJvdygnTm90SW1wbGVtZW50ZWRFeGNlcHRpb24nKTtcdFxyXG5cdH1cclxuXHJcblx0c2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcblx0XHR0aHJvdygnTm90SW1wbGVtZW50ZWRFeGNlcHRpb24nKTtcdFxyXG5cdH1cclxuXHJcblx0b25EZXN0cm95KCkge1xyXG5cdFx0aWYgKHRoaXMuZ2FtZSA9PT0gJ3RpY3RhY3RvZScpIHtcclxuXHRcdFx0bGV0IGJvYXJkQ2VsbHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZmxleC1pdGVtJyksXHJcblx0XHRcdFx0Ym9hcmRDZWxsc0xlbmd0aCA9IGJvYXJkQ2VsbHMubGVuZ3RoO1xyXG5cclxuXHRcdFx0Zm9yKGxldCBpID0gMDsgaSA8IGJvYXJkQ2VsbHNMZW5ndGg7IGkrKykge1xyXG5cdFx0XHRcdGJvYXJkQ2VsbHNbaV0ucmVtb3ZlRXZlbnRMaXN0ZW5lcih0aGlzLm9uQ2VsbENsaWNrZWQpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG59XHJcbiIsImltcG9ydCB7U3dvcmRHYW1lc30gZnJvbSAnLi9zd29yZGdhbWVzJztcclxuXHJcbmV4cG9ydCBjbGFzcyBUaWNUYWNUb2UgZXh0ZW5kcyBTd29yZEdhbWVzIHtcclxuICAgIGNvbnN0cnVjdG9yKGJvYXJkU2l6ZSA9IDMpIHtcclxuICAgICAgICBzdXBlcigpO1xyXG4gICAgICAgIHRoaXMuYm9hcmRTaXplID0gYm9hcmRTaXplO1xyXG4gICAgICAgIHRoaXMucm91bmRXaW5zQnlQbGF5ZXIgPSB7XHJcbiAgICAgICAgICAgIHBsYXllcjE6IDAsXHJcbiAgICAgICAgICAgIHBsYXllcjI6IDBcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIG9uSW5pdCgpIHtcclxuICAgICAgICB0aGlzLndpbm5pbmdDb25kaXRpb25zID0gQXJyYXkuZnJvbSh7XHJcbiAgICAgICAgICAgIGxlbmd0aDogKHRoaXMuYm9hcmRTaXplICogMikgKyAyXHJcbiAgICAgICAgfSwgKCkgPT4gKG5ldyBBcnJheSh0aGlzLmJvYXJkU2l6ZSkpKTtcclxuXHJcbiAgICAgICAgdGhpcy5ib2FyZFN0YXR1cyA9IG5ldyBBcnJheSh0aGlzLmJvYXJkU2l6ZSAqIHRoaXMuYm9hcmRTaXplKS5maWxsKCcnKTtcclxuXHJcbiAgICAgICAgdGhpcy5idWlsZFJvd3MoKTtcclxuICAgICAgICB0aGlzLmJ1aWxkQ29scygpO1xyXG4gICAgICAgIHRoaXMuYnVpbGRMdHJEaWFnKCk7XHJcbiAgICAgICAgdGhpcy5idWlsZFJ0ckRpYWcoKTtcclxuY29uc29sZS5kZWJ1Zyh0aGlzLndpbm5pbmdDb25kaXRpb25zLCB0aGlzLmJvYXJkU2l6ZSk7XHJcbiAgICAgICAgdGhpcy5idWlsZEJvYXJkKCk7XHJcblxyXG4gICAgICAgIHRoaXMuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcblxyXG4gICAgfVxyXG5cclxuICAgIGJ1aWxkUm93cygpIHtcclxuICAgICAgICBsZXQgcm93QWNjdW11bGF0b3IgPSAtMTtcclxuICAgICAgICBmb3IgKGxldCByb3cgPSAwOyByb3cgPCB0aGlzLmJvYXJkU2l6ZTsgcm93KyspIHtcclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmJvYXJkU2l6ZTsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICArK3Jvd0FjY3VtdWxhdG9yO1xyXG4gICAgICAgICAgICAgICAgdGhpcy53aW5uaW5nQ29uZGl0aW9uc1tyb3ddW2ldID0gcm93QWNjdW11bGF0b3I7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgYnVpbGRDb2xzKCkge1xyXG4gICAgICAgIGxldCBjb2xBY2N1bXVsYXRvciA9IC0xLFxyXG4gICAgICAgICAgICB3aW5uaW5nQ29uZGl0aW9uc0xlbmd0aCA9IHRoaXMud2lubmluZ0NvbmRpdGlvbnMubGVuZ3RoO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5ib2FyZFNpemU7IGkrKykge1xyXG4gICAgICAgICAgICBmb3IgKGxldCBjb2wgPSB0aGlzLmJvYXJkU2l6ZTsgY29sIDw9IHdpbm5pbmdDb25kaXRpb25zTGVuZ3RoIC0gMzsgY29sKyspIHtcclxuICAgICAgICAgICAgICAgICsrY29sQWNjdW11bGF0b3I7XHJcbiAgICAgICAgICAgICAgICB0aGlzLndpbm5pbmdDb25kaXRpb25zW2NvbF1baV0gPSBjb2xBY2N1bXVsYXRvcjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBidWlsZEx0ckRpYWcoKSB7XHJcbiAgICAgICAgbGV0IHdpbm5pbmdDb25kaXRpb25zTGVuZ3RoID0gdGhpcy53aW5uaW5nQ29uZGl0aW9ucy5sZW5ndGg7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmJvYXJkU2l6ZTsgaSsrKSB7XHJcbiAgICAgICAgICAgIHRoaXMud2lubmluZ0NvbmRpdGlvbnNbd2lubmluZ0NvbmRpdGlvbnNMZW5ndGggLSAyXVtpXSA9IGkgKiAodGhpcy5ib2FyZFNpemUgKyAxKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgYnVpbGRSdHJEaWFnKCkge1xyXG4gICAgICAgIGxldCBhID0gdGhpcy5ib2FyZFNpemUgLSAxLFxyXG4gICAgICAgICAgICB3aW5uaW5nQ29uZGl0aW9uc0xlbmd0aCA9IHRoaXMud2lubmluZ0NvbmRpdGlvbnMubGVuZ3RoO1xyXG5cdCAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuYm9hcmRTaXplOyBpKyspIHtcclxuICBcdCAgICAgICAgdGhpcy53aW5uaW5nQ29uZGl0aW9uc1t3aW5uaW5nQ29uZGl0aW9uc0xlbmd0aCAtIDFdW2ldID0gKGkgKiBhKSArIGE7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGJ1aWxkQm9hcmQoKSB7XHJcbiAgICAgICAgbGV0IGJvYXJkQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2JvYXJkJyksXHJcbiAgICAgICAgICAgIGJvYXJkID0gJycsXHJcbiAgICAgICAgICAgIGNvdW50ZXIgPSAtMTtcclxuXHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmJvYXJkU2l6ZTsgaSsrKSB7XHJcbiAgICAgICAgICAgIGJvYXJkICs9ICc8ZGl2IGNsYXNzPVwiZmxleC1jb250YWluZXJcIj4nO1xyXG4gICAgICAgICAgICBmb3IobGV0IGogPSAwOyBqIDwgdGhpcy5ib2FyZFNpemU7IGorKykge1xyXG4gICAgICAgICAgICAgICAgKytjb3VudGVyO1xyXG4gICAgICAgICAgICAgICAgYm9hcmQgKz0gYDxkaXYgY2xhc3M9XCJmbGV4LWl0ZW1cIiBkYXRhLWNlbGwtaWQ9XCIke2NvdW50ZXJ9XCI+PC9kaXY+YDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBib2FyZCArPSAnPC9kaXY+JztcclxuICAgICAgICB9XHJcbiAgICAgICAgYm9hcmRDb250YWluZXIuaW5uZXJIVE1MID0gYm9hcmQ7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAgICAgbGV0IGJvYXJkQ2VsbHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZmxleC1pdGVtJyksXHJcbiAgICAgICAgICAgIGJvYXJkQ2VsbHNMZW5ndGggPSBib2FyZENlbGxzLmxlbmd0aDtcclxuXHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBib2FyZENlbGxzTGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgYm9hcmRDZWxsc1tpXS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMub25DZWxsQ2xpY2tlZC5iaW5kKHRoaXMpKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBNYW5hZ2UgYm9hcmQgY2VsbCBjbGlja3MuIElmIGNlbGwgYWxyZWFkeSBjbGlja2VkIGRvbnQgYWxsb3cgYSBtb3ZlIG9uIHRoYXQgY2VsbFxyXG4gICAgICogQHBhcmFtIHtvYmplY3R9IGV2IFxyXG4gICAgICogQHJldHVybnMgXHJcbiAgICAgKi9cclxuICAgIG9uQ2VsbENsaWNrZWQoZXYpIHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBsZXQgY2xpY2tlZENlbGwgPSArZXYudGFyZ2V0LmRhdGFzZXQuY2VsbElkO1xyXG4gICAgICAgICAgICBjb25zb2xlLmRlYnVnKCdvbiBjZWxsIGNsaWNrZWQnLCB0aGlzLmRhdGFzZXQpO1xyXG5cclxuICAgICAgICAgICAgLy8gY2tlY2sgaWYgY2VsbCBpcyBhdmFpbGFibGVcclxuICAgICAgICAgICAgaWYgKHRoaXMuYm9hcmRTdGF0dXNbY2xpY2tlZENlbGxdICE9PSAnJykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB0aGlzLmNlbGxQbGF5ZWRIYW5kbGVyKGV2LnRhcmdldCwgY2xpY2tlZENlbGwpO1xyXG4gICAgICAgIH0gY2F0Y2goZSkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGUpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFxyXG4gICAgICogQHBhcmFtIHtvYmplY3R9IGNlbGwgXHJcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gY2VsbEluZGV4IFxyXG4gICAgICovXHJcbiAgICBjZWxsUGxheWVkSGFuZGxlcihjZWxsID0gbnVsbCwgY2VsbEluZGV4ID0gLTEpIHtcclxuICAgICAgICBpZiAoIWNlbGwgfHwgY2VsbEluZGV4ID09PSAtMSkge1xyXG4gICAgICAgICAgICB0aHJvdygnSW52YWxpZENlbGxFeGNlcHRpb24nKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNlbGwuY2xhc3NMaXN0LmFkZCh0aGlzLnBsYXllciA9PT0gJzEnID8gJ3BsYXllcjEnIDogJ3BsYXllcjInKTtcclxuICAgICAgICB0aGlzLmJvYXJkU3RhdHVzW2NlbGxJbmRleF0gPSB0aGlzLnBsYXllcjtcclxuICAgICAgICB0aGlzLmNoZWNrV2luKCk7XHJcbiAgICB9XHJcblxyXG4gICAgY2hlY2tXaW4oKSB7XHJcblxyXG4gICAgICAgIGxldCB2aWN0b3J5ID0gZmFsc2UsXHJcbiAgICAgICAgICAgIGRyYXcgPSBmYWxzZSxcclxuICAgICAgICAgICAgd2lubmluZ0NvbmRpdGlvbnNMZW5ndGggPSB0aGlzLndpbm5pbmdDb25kaXRpb25zLmxlbmd0aCxcclxuICAgICAgICAgICAgd2lubmluZ0NvbmRpdGlvbiA9IG51bGw7XHJcblxyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgd2lubmluZ0NvbmRpdGlvbnNMZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICB3aW5uaW5nQ29uZGl0aW9uID0gdGhpcy53aW5uaW5nQ29uZGl0aW9uc1tpXTtcclxuXHJcbiAgICAgICAgICAgIGxldCB0ZXN0ID0gW107XHJcblxyXG4gICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHRoaXMuYm9hcmRTaXplOyBqKyspIHtcclxuICAgICAgICAgICAgICAgIHRlc3QucHVzaCh0aGlzLmJvYXJkU3RhdHVzW3dpbm5pbmdDb25kaXRpb25bal1dKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKHRlc3Quc29tZShlbGVtID0+IHtyZXR1cm4gZWxlbSA9PT0gJyc7fSkpIHtcclxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAodGVzdC5ldmVyeShlbGVtID0+IGVsZW0gPT09IHRlc3RbMF0pKSB7XHJcbiAgICAgICAgICAgICAgICB2aWN0b3J5ID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvKiBcclxuICAgICAgICAgICAgbGV0IGNlbGwxID0gdGhpcy5ib2FyZFN0YXR1c1t3aW5uaW5nQ29uZGl0aW9uWzBdXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2VsbDIgPSB0aGlzLmJvYXJkU3RhdHVzW3dpbm5pbmdDb25kaXRpb25bMV1dLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjZWxsMyA9IHRoaXMuYm9hcmRTdGF0dXNbd2lubmluZ0NvbmRpdGlvblsyXV07XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChjZWxsMSA9PT0gJycgfHwgY2VsbDIgPT09ICcnIHx8IGNlbGwzID09PSAnJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChjZWxsMSA9PT0gY2VsbDIgJiYgY2VsbDIgPT09IGNlbGwzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZpY3RvcnkgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAqL1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICBpZiAodmljdG9yeSkge1xyXG4gICAgICAgICAgICAvLyBoaWdobGlnaHQgbGluZVxyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuYm9hcmRTaXplOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGxldCBjZWxsSWQgPSB3aW5uaW5nQ29uZGl0aW9uW2ldLFxyXG4gICAgICAgICAgICAgICAgICAgIGJvYXJkQ2VsbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYFtkYXRhLWNlbGwtaWQ9XCIke2NlbGxJZH1cIl1gKTtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgYm9hcmRDZWxsLmNsYXNzTGlzdC5hZGQoYHBsYXllciR7dGhpcy5wbGF5ZXJ9V2luYCwgJ3dpbm5pbmctY2VsbCcpO1xyXG4gICAgICAgICAgICAgICAgYm9hcmRDZWxsLmNsYXNzTGlzdC5yZW1vdmUoYHBsYXllciR7dGhpcy5wbGF5ZXJ9YCk7XHJcblxyXG4gICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXN0YXJ0R2FtZSgpO1xyXG4gICAgICAgICAgICAgICAgfSwgNDAwMCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcblxyXG4gICAgICAgICAgICB0aGlzLnJvdW5kV2luc0J5UGxheWVyWydwbGF5ZXInK3RoaXMucGxheWVyXSArPSAxO1xyXG4gICAgICAgICAgICAvLyBmaXJzdCBwbGF5ZXIgdG8gZ2V0IDUgcm91bmRzIGlzIHRoZSB3aW5uZXJcclxuXHJcbiAgICAgICAgICAgIGlmICh0aGlzLnJvdW5kV2luc0J5UGxheWVyLnBsYXllcjEgPT09IDUgfHwgdGhpcy5yb3VuZFdpbnNCeVBsYXllci5wbGF5ZXIyID09PSA1KSB7XHJcbiAgICAgICAgICAgICAgICAvLyBkaXNwbGF5IGNvbmdyYXRzIG1lc3NhZ2UgYW5kIHNjcm9sbCB0byBuZXh0IHNlY3Rpb25cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gYXJyaXZpbmcgaGVyZSBubyB2aWN0b3J5IGZvdW5kLiBpdCBpcyBhIGRyYXcgaWYgYWxsIGNlbGxzIGFyZSBmaWxsZWRcclxuICAgICAgICBkcmF3ID0gIXRoaXMuYm9hcmRTdGF0dXMuaW5jbHVkZXMoJycpO1xyXG4gICAgICAgIGlmIChkcmF3KSB7XHJcbiAgICAgICAgICAgIC8vIGNsZWFyIGJvYXJkIGFuZCBzdGFydCBhZ2FpblxyXG4gICAgICAgICAgICB0aGlzLnJlc3RhcnRHYW1lKCk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMubWFuYWdlUGxheWVyQ2hhbmdlKCk7XHJcbiAgICB9XHJcblxyXG4gICAgbWFuYWdlUGxheWVyQ2hhbmdlKCkge1xyXG4gICAgICAgIHRoaXMucGxheWVyID0gdGhpcy5wbGF5ZXIgPT09ICcxJyA/ICcyJyA6ICcxJztcclxuICAgIH1cclxuXHJcbiAgICByZXN0YXJ0R2FtZSgpIHtcclxuICAgICAgICB0aGlzLnBsYXllciA9ICcxJztcclxuICAgICAgICB0aGlzLmJvYXJkU3RhdHVzLmZpbGwoJycpO1xyXG5cclxuICAgICAgICBsZXQgYm9hcmRDZWxscyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5mbGV4LWl0ZW0nKSxcclxuICAgICAgICAgICAgYm9hcmRDZWxsc0xlbmd0aCA9IGJvYXJkQ2VsbHMubGVuZ3RoLFxyXG4gICAgICAgICAgICBhcHBsaWVkQ2xhc3NlcyA9IFsncGxheWVyMScsICdwbGF5ZXIyJywgJ3BsYXllcjFXaW4nLCAncGxheWVyMldpbicsICd3aW5uaW5nLWNlbGwnXTtcclxuXHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBib2FyZENlbGxzTGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgYm9hcmRDZWxsc1tpXS5jbGFzc0xpc3QucmVtb3ZlKC4uLmFwcGxpZWRDbGFzc2VzKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuIiwiLy8gZGVmaW5lIGdldHRlciBmdW5jdGlvbnMgZm9yIGhhcm1vbnkgZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kID0gKGV4cG9ydHMsIGRlZmluaXRpb24pID0+IHtcblx0Zm9yKHZhciBrZXkgaW4gZGVmaW5pdGlvbikge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhkZWZpbml0aW9uLCBrZXkpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywga2V5KSkge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGRlZmluaXRpb25ba2V5XSB9KTtcblx0XHR9XG5cdH1cbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5vID0gKG9iaiwgcHJvcCkgPT4gKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApKSIsIi8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uciA9IChleHBvcnRzKSA9PiB7XG5cdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuXHR9XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG59OyIsIi8vIHN0YXJ0dXBcbi8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXyhcIi4vc3JjL2luZGV4LmpzXCIpO1xuLy8gVGhpcyBlbnRyeSBtb2R1bGUgaXMgcmVmZXJlbmNlZCBieSBvdGhlciBtb2R1bGVzIHNvIGl0IGNhbid0IGJlIGlubGluZWRcbnZhciBfX3dlYnBhY2tfZXhwb3J0c19fID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcIi4vc3JjL3Nhc3MvbWFpbi5zY3NzXCIpO1xuIl0sInNvdXJjZVJvb3QiOiIifQ==